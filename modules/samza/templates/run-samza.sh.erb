#!/bin/bash

# Managed by puppet

<%- if @vertical_name == 'samza_eu' -%>
# yap-notification EU run file.

export SAMZA_LOG_DIR=/var/log/samza/yap-notifications-eu
export JAVA_OPTS="$JAVA_OPTS
                  -javaagent:/usr/share/newrelic/newrelic.jar
                  -Dnewrelic.config.file=/usr/share/newrelic/samza-eu-newrelic.yml
                  -Dlog4j.configuration=file:$(dirname $0)/log4j-console.xml"

exec $(dirname $0)/run-class.sh org.apache.samza.job.JobRunner --config-factory=org.apache.samza.config.factories.PropertiesConfigFactory --config-path=file:///opt/yap-notifications/config/notification-message-subscriber-EU.properties "$@"


<%- elsif @vertical_name == 'samza_ha' -%>
# yap-notification HA run file.

export SAMZA_LOG_DIR=/var/log/samza/yap-notifications-ha
export JAVA_OPTS="$JAVA_OPTS
                  -javaagent:/usr/share/newrelic/newrelic.jar
                  -Dnewrelic.config.file=/usr/share/newrelic/samza-ha-newrelic.yml
                  -Dlog4j.configuration=file:$(dirname $0)/log4j-console.xml"

exec $(dirname $0)/run-class.sh org.apache.samza.job.JobRunner --config-factory=org.apache.samza.config.factories.PropertiesConfigFactory --config-path=file:///opt/yap-notifications/config/notification-message-subscriber-HA.properties "$@"

<%- elsif @vertical_name == 'samza_rp' -%>
# yap-notification RP run file.

export SAMZA_LOG_DIR=/var/log/samza/yap-notifications-rp
export JAVA_OPTS="$JAVA_OPTS
                  -javaagent:/usr/share/newrelic/newrelic.jar
                  -Dnewrelic.config.file=/usr/share/newrelic/samza-rp-newrelic.yml
                  -Dlog4j.configuration=file:$(dirname $0)/log4j-console.xml"

exec $(dirname $0)/run-class.sh org.apache.samza.job.JobRunner --config-factory=org.apache.samza.config.factories.PropertiesConfigFactory --config-path=file:///opt/yap-notifications/config/notification-message-subscriber-RP.properties "$@"

<%- end -%>
